{% load static %}
<nav class="navbar" role="navigation" aria-label="main navigation" style="padding: 0.5rem 1rem">
    <div class="navbar-brand">
        <a class="navbar-item" href="{% url 'frontpage' %}">
            <svg viewBox="2.344402499999999 4.60938125 157.86092312499997 35.39154375"
                 style="width: 112px; height: 32px;">
                <path d="M19.688 40 l-15.41 0 q-0.80078125 0 -1.3671875 -0.56640625 t-0.56641 -1.3672 q0 -0.8203125 0.56640625 -1.38671875 t1.3672 -0.56641 l15.41 0 q0.80078125 0 1.3671875 0.56640625 t0.56641 1.3867 q0 0.80078125 -0.56640625 1.3671875 t-1.3672 0.56641 z M19.688 15.859000000000002 l-15.41 0 q-0.80078125 0 -1.3671875 -0.56640625 t-0.56641 -1.3672 t0.56641 -1.3672 t1.3672 -0.56641 l15.41 0 q0.80078125 0 1.3671875 0.56640625 t0.56641 1.3672 t-0.56641 1.3672 t-1.3672 0.56641 z M19.688 27.93 l-15.41 0 q-0.80078125 0 -1.3671875 -0.56640625 t-0.56641 -1.3672 t0.56641 -1.377 t1.3672 -0.57617 l15.41 0 q0.80078125 0 1.3671875 0.576171875 t0.56641 1.377 t-0.56641 1.3672 t-1.3672 0.56641 z M28.439409375 40 q-0.80078125 0 -1.3671875 -0.56640625 t-0.56641 -1.3672 l0 -12.07 q0 -0.80078125 0.56640625 -1.376953125 t1.3672 -0.57617 l10.469 0 q1.9140625 0 3.0078125 -1.2109375 q1.015625 -1.23046875 1.015625 -2.87109375 q0 -0.76171875 -0.3515625 -1.728515625 t-1.2207 -1.6699 t-2.4512 -0.70313 l-2.2461 0 q-0.80078125 0 -1.376953125 -0.56640625 t-0.57617 -1.3672 t0.57617 -1.3672 t1.377 -0.56641 l2.2461 0 q2.59765625 0 4.35546875 1.162109375 t2.6465 2.9883 t0.88867 3.8184 q0 3.06640625 -1.97265625 5.4296875 q-0.5078125 0.5859375 -1.30859375 1.171875 t-1.9434 0.97656 t-2.666 0.39063 l-8.5156 0 l0 10.137 q0 0.80078125 -0.56640625 1.3671875 t-1.3867 0.56641 z M28.439409375 15.859000000000002 q-0.80078125 0 -1.3671875 -0.56640625 t-0.56641 -1.3672 t0.56641 -1.3672 t1.3672 -0.56641 q0.8203125 0 1.38671875 0.56640625 t0.56641 1.3672 t-0.56641 1.3672 t-1.3867 0.56641 z M53.81245625 40 q-0.80078125 0 -1.3671875 -0.56640625 t-0.56641 -1.3672 l0 -12.07 q0 -0.80078125 0.56640625 -1.376953125 t1.3672 -0.57617 l10.469 0 q1.9140625 0 3.0078125 -1.2109375 q1.015625 -1.23046875 1.015625 -2.87109375 q0 -0.76171875 -0.3515625 -1.728515625 t-1.2207 -1.6699 t-2.4512 -0.70313 q-0.80078125 0 -1.3671875 -0.56640625 t-0.56641 -1.3672 t0.56641 -1.3672 t1.3672 -0.56641 q2.578125 0 4.3359375 1.162109375 t2.6563 2.9883 t0.89844 3.8184 q0 3.06640625 -1.97265625 5.4296875 q-0.5078125 0.5859375 -1.30859375 1.162109375 t-1.9434 0.97656 t-2.666 0.40039 l-8.5156 0 l0 10.137 q0 0.80078125 -0.576171875 1.3671875 t-1.377 0.56641 z M70.21915625 40 q-1.07421875 0 -1.73828125 -1.09375 l-2.5586 -5.1758 q-0.1953125 -0.44921875 -0.1953125 -0.87890625 q0 -1.15234375 1.07421875 -1.71875 q0.4296875 -0.1953125 0.87890625 -0.1953125 q1.171875 0 1.73828125 1.09375 l2.5391 5.1758 q0.1953125 0.44921875 0.1953125 0.87890625 q0 1.15234375 -1.07421875 1.71875 q-0.4296875 0.1953125 -0.859375 0.1953125 z M89.028953125 10.625 q-0.76171875 0 -1.38671875 -0.56640625 q-0.56640625 -0.60546875 -0.56640625 -1.3671875 q0 -0.78125 0.56640625 -1.38671875 l2.1289 -2.1289 q0.60546875 -0.56640625 1.38671875 -0.56640625 q0.76171875 0 1.34765625 0.5859375 t0.58594 1.3672 q0 0.76171875 -0.5859375 1.34765625 l-2.1289 2.1289 q-0.60546875 0.5859375 -1.34765625 0.5859375 z M90.064953125 40 q3.88671875 0 7.060546875 -1.89453125 t5.0684 -5.0781 t1.8945 -7.0313 q0 -3.73046875 -1.9140625 -7.0703125 q-1.85546875 -3.14453125 -5 -5.01953125 q-0.48828125 -0.25390625 -0.9765625 -0.25390625 q-1.07421875 0 -1.66015625 0.9375 q-0.29296875 0.48828125 -0.29296875 0.99609375 q0 1.07421875 0.95703125 1.66015625 q2.36328125 1.40625 3.69140625 3.73046875 t1.3281 5.0195 q0 2.79296875 -1.3671875 5.087890625 t-3.6719 3.6621 t-5.1172 1.3672 q-2.7734375 0 -5.078125 -1.3671875 t-3.6719 -3.6621 t-1.3672 -5.0879 q0 -0.8203125 0.1171875 -1.62109375 l0.039063 -0.33203 q0 -0.625 -0.41015625 -1.19140625 q-0.546875 -0.72265625 -1.50390625 -0.72265625 q-0.6640625 0 -1.220703125 0.41015625 t-0.73242 1.2109 q-0.15625 1.11328125 -0.15625 2.24609375 q0 3.84765625 1.884765625 7.03125 t5.0684 5.0781 t7.0313 1.8945 z M121.84421875 40 l-10.742 0 q-0.80078125 0 -1.3671875 -0.56640625 t-0.56641 -1.3672 l0 -12.07 q0 -0.80078125 0.56640625 -1.376953125 t1.3672 -0.57617 l10.742 0 q1.93359375 0 3.0078125 -1.2109375 q1.015625 -1.23046875 1.015625 -2.87109375 q0 -0.76171875 -0.341796875 -1.728515625 t-1.2207 -1.6699 t-2.4609 -0.70313 l-10.742 0 q-0.80078125 0 -1.3671875 -0.56640625 t-0.56641 -1.3672 t0.56641 -1.3672 t1.3672 -0.56641 l10.742 0 q2.59765625 0 4.35546875 1.162109375 t2.6465 2.9883 t0.88867 3.8184 q0 3.06640625 -1.97265625 5.4296875 q-0.25390625 0.29296875 -0.5859375 0.5859375 q1.26953125 1.19140625 1.9140625 2.783203125 t0.64453 3.2715 q0 3.06640625 -1.97265625 5.41015625 q-0.5078125 0.60546875 -1.30859375 1.181640625 t-1.9434 0.97656 t-2.666 0.40039 z M121.84421875 36.1133 q1.93359375 0 3.0078125 -1.2109375 q1.015625 -1.23046875 1.015625 -2.87109375 q0 -0.76171875 -0.341796875 -1.728515625 t-1.2207 -1.6699 t-2.4609 -0.70313 l-8.8086 0 l0 8.1836 l8.8086 0 z M135.966803125 40 q-0.41015625 0 -0.8203125 -0.17578125 q-1.11328125 -0.546875 -1.11328125 -1.7578125 q0 -0.41015625 0.17578125 -0.83984375 l11.152 -24.121 q0.64453125 -1.1328125 1.77734375 -1.1328125 t1.7383 1.1328 l7.9883 17.305 q0.1953125 0.41015625 0.1953125 0.8203125 q0 1.19140625 -1.1328125 1.73828125 q-0.4296875 0.1953125 -0.83984375 0.1953125 q-1.171875 0 -1.71875 -1.1328125 l-6.2305 -13.496 l-9.3945 20.352 q-0.68359375 1.11328125 -1.77734375 1.11328125 z M158.271703125 39.941406 q-0.80078125 0 -1.3671875 -0.56640625 t-0.56641 -1.3672 t0.56641 -1.3672 t1.3672 -0.56641 t1.3672 0.56641 t0.56641 1.3672 t-0.56641 1.3672 t-1.3672 0.56641 z"
                      style="fill: var(--logo-color)"></path>
            </svg>
        </a>

        <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
    </div>

    <div id="navMenu" class="navbar-menu">
        <div class="navbar-start">
            <a class="navbar-item" href="{% url 'worksheets:worksheets' %}">
                Twoje próby
            </a>
            {% if request.user.function >= 2 %}
                <div class="navbar-item has-dropdown is-hoverable">
                    <a class="navbar-link" href="{% url 'worksheets:manage_worksheets' %}">
                        Zarządzaj próbami
                    </a>
                    <div class="navbar-dropdown">
                        <a class="navbar-item" href="{% url 'worksheets:check_tasks' %}">
                            Prośby o zatwierdzenie
                        </a>
                        <a class="navbar-item" href="{% url 'worksheets:manage_worksheets' %}">
                            Zarządzaj próbami
                        </a>
                        <a class="navbar-item" href="{% url 'worksheets:archive' %}">
                            Archiwum
                        </a>
                        <a class="navbar-item"
                           onclick="location.href='{% url 'worksheets:create_worksheet' %}?next={% url 'worksheets:manage_worksheets' %}'">
                            Utwórz nową próbę
                        </a>
                        <a class="navbar-item" onclick="location.href='{% url 'worksheets:templates' %}'">
                            Szablony
                        </a>
                    </div>
                </div>
            {% endif %}
            {% if request.user.is_superuser %}
                <div class="navbar-item has-dropdown is-hoverable">
                    <a class="navbar-link" href="/admin">
                        Admin
                    </a>

                    <div class="navbar-dropdown">
                        <a class="navbar-item" href="{% url 'site_management' %}">
                            Zarządzaj stroną
                        </a>
                    </div>
                </div>
            {% elif request.user.is_staff %}
                <a class="navbar-item" href="/admin">
                    Admin
                </a>
            {% endif %}
            {% if request.user.function >= 3 %}
                <div class="navbar-item has-dropdown is-hoverable">
                    <a class="navbar-link" href="{% url 'teams:view_teams' %}">
                        Twoja drużyna
                    </a>

                    <div class="navbar-dropdown">
                        <a class="navbar-item" href="{% url 'teams:view_teams' %}">
                            Zarządzaj drużyną
                        </a>
                        <a class="navbar-item" href="#">
                            Statystyki (wkrótce)
                        </a>
                    </div>
                </div>
            {% endif %}
            <div class="navbar-item has-dropdown is-hoverable">
                <a class="navbar-link">
                    Więcej
                </a>

                <div class="navbar-dropdown">
                    <a class="navbar-item" href="{% url 'about' %}">
                        O stronie
                    </a>
                    <a class="navbar-item" href="{% url 'contact' %}">
                        Kontakt
                    </a>
                    <hr class="navbar-divider">
                    <a class="navbar-item" href="https://github.com/eproba/web/issues" target="_blank">
                        Zgłoś błąd na stronie
                    </a>
                </div>
            </div>
        </div>

        <div class="navbar-end">
            <div class="navbar-item">
                <div class="buttons">
                    {% if request.user.is_authenticated %}
                        <a href="{% url 'view_profile' %}" class="button is-primary">
                            <span class="icon">
                              <i class="fas fa-user"></i>
                            </span>
                        </a>
                        <form method="post" action="{% url 'logout' %}">
                            {% csrf_token %}
                            <button type="submit" class="button is-danger">
                                <span class="icon">
                                  <i class="fas fa-sign-out-alt"></i>
                                </span>
                            </button>
                        </form>
                    {% else %}
                        <a href="{% url 'signup' %}" class="button is-primary">
                            <span class="icon">
                              <i class="fas fa-user-plus"></i>
                            </span>
                            <span>Załóż konto</span>
                        </a>
                        <a href="{% url 'login' %}" class="button is-inverted">
                            <span class="icon">
                              <i class="fas fa-sign-in-alt"></i>
                            </span>
                            <span>Zaloguj się</span>
                        </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</nav>

{% if messages %}
    <br>
    {% for message in messages %}
        <div class="notification mb-2 p-4 mx-3 is-{% if message.tags == 'error' %}danger{% else %}{{ message.tags }}{% endif %}">
            <p {% if message.tags %} class="{{ message.tags }}"{% endif %}>
                {{ message }}
            </p>
        </div>
    {% endfor %}
{% endif %}

{% if request.user.is_authenticated %}
    {% if not request.user.email_verified  or not request.user.patrol %}
        {% if  request.path != '/select-patrol/' and request.path != '/signup/finalize/' %}
            <div class="notification my-2 p-4 mx-3 is-warning">
                {% if not request.user.email_verified %}
                    <p>
                        Na twój adres e-mail została wysłana wiadomość weryfikacyjna. Kliknij w link w wiadomości aby
                        zweryfikować swój adres. Jeśli nie otrzymałeś e-maila, sprawdź folder spam lub
                        <a href="{% url 'send_verification_email' %}">wyślij go ponownie</a>.
                    </p>
                {% endif %}
                {% if not request.user.patrol and request.path != '/select-patrol/' %}
                    <p>
                        Nie jesteś jeszcze przypisany do żadnej jednostki. <a href="{% url 'select_patrol' %}">Kliknij
                        tutaj</a> aby wybrać jednostkę i uzyskać dostęp do wszystkich funkcji Epróby.
                    </p>
                {% endif %}
            </div>
        {% endif %}
    {% endif %}
{% endif %}
